import{j as e,r as i,W as R,a as G}from"./app-5273161b.js";import{A as I}from"./AuthenticatedLayout-a2f40245.js";import{f as b}from"./index-0bd7da91.js";import{M as C}from"./Modal-ced38327.js";import"./transition-3bc6a401.js";const U=({data:r,click:w,open:l,adm:x})=>{const N=b(new Date(r.created_at),"dd/MM/yyyy hh:mm:ss a"),n=["bg-blue-500","bg-yellow-500","bg-cyan-500","bg-blue-800"],t=["bg-lime-100","bg-orange-100","bg-orange-100","bg-green-100","bg-red-100","bg-red-100"];return e.jsxs("li",{onClick:w,className:`flex w-80 ${t[r.status_id-1]} ${l==r.id?"border-2 scale-90":""} duration-300 rounded-md cursor-pointer`,children:[e.jsx("div",{className:`h-full w-2 ${n[r.tipo.tipo-1]} rounded-l-lg`}),e.jsxs("div",{className:"flex flex-col gap-2 p-2 text-textgray w-full",children:[x?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:r.user.name}),e.jsxs("span",{children:["#",r.numero]})]}):e.jsxs("span",{children:["Solicitud: ",r.numero]}),e.jsxs("p",{className:"font-medium text-sm",children:[r.tipo.nombre,r.tipo_id==1?" "+r.descripcion:""]}),e.jsxs("div",{className:"flex justify-between pe-5 ",children:[e.jsx("span",{className:"text-xs",children:N}),e.jsx("span",{className:"text-xs",children:r.status.nombre})]})]})]})};function P({auth:r,tipoSolicitudes:w,msj:l,solicitud_id:x,statusList:N}){const n=r.user.solicitudes.filter(s=>s.tipo_id>2),[t,j]=i.useState(null),[d,S]=i.useState(0),[v,_]=i.useState(0),[f,M]=i.useState(n),[O,c]=i.useState(!1),{data:h,setData:u,post:y}=R(null),[T,p]=i.useState(l!=null),[W,k]=i.useState(!1),[E,A]=i.useState("");i.useEffect(()=>{if(M(n),d){const s=n.find(a=>a.id===d);j(s),u(s)}},[r.user.solicitudes]),i.useEffect(()=>{((l==null?void 0:l.error)==null||(l==null?void 0:l.error)==[])&&(A(""),p(l!=null))},[l]),i.useEffect(()=>{x&&!d&&D(parseInt(x))},[x]);const D=s=>{if(d==s)S(0),j(null);else{S(s);const a=n.find(o=>o.id===s);j(a),u(a)}},B=s=>{const a=s.target.value.toLowerCase(),o=n.filter(m=>JSON.stringify(m).toLowerCase().includes(a));M(o)},L=s=>{v==s?_(0):_(s)},z=s=>{const a=s.id,o=s.nombre+"."+s.extencion;axios.post("/download",{id:a},{responseType:"blob"}).then(m=>{const $=window.URL.createObjectURL(new Blob([m.data])),g=document.createElement("a");g.href=$,g.setAttribute("download",o),document.body.appendChild(g),g.click()}).catch(m=>{console.error("Error al descargar el archivo:",m)})},F=s=>{s.preventDefault(),y(route("solicitud.update"))};return e.jsxs(I,{user:r.user,msj:l,countNotificaciones:r.countNotificaciones,solicitud_id:d,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Administración de solicitudes"}),children:[e.jsx(G,{title:"Solicitudes"}),e.jsx("div",{className:" pb-1  ",children:e.jsxs("div",{className:" m-5 h-full bg-white shadow-lg   rounded-md gap-10 p-10 pt-4",children:[e.jsxs("label",{className:" flex items-center border-2 border-black w-80 h-9 text-sm bg-white rounded-lg overflow-hidden p-2 font-medium mb-5",children:["Buscar",e.jsx("input",{onChange:B,className:"border-none h-full w-full outline-none focus:ring-0"})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("ul",{className:"flex flex-col gap-4 overflow-hidden hover:overflow-y-scroll w-full h-full max-h-[740px]",children:f!=null&&f.length?f.map(s=>e.jsx(U,{adm:r.user.id!=2,data:s,click:()=>D(s.id),open:d},s.id)):e.jsx("h1",{children:"No hay Solicitudes"})}),t?e.jsxs("div",{className:"flex flex-col gap-3 w-[520px] p-4 bg-white",children:[t.status_id==1&&r.user.id==t.user.id&&e.jsx("div",{className:"font-bold w-full flex justify-end",children:e.jsx("button",{onClick:()=>c(!0),className:"bg-blue-400 px-2 py-1 rounded-lg font-semibold text-white",children:" Editar "})}),e.jsxs("table",{children:[e.jsx("thead",{}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"w-fit p-6",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Número solicitud"}),e.jsx("td",{children:t.numero})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Fecha"}),e.jsx("td",{children:b(new Date(t.created_at),"dd/MM/yyyy hh:mm:ss a")})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Tramite"}),e.jsx("td",{children:t.tipo.nombre})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Nombre empresa"}),e.jsx("td",{children:t.user.empresa})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"RNC"}),e.jsx("td",{children:t.user.rnc})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Nombre solicitante"}),e.jsx("td",{children:t.user.name})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Télefono"}),e.jsx("td",{children:t.user.telefono})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Correo"}),e.jsx("td",{children:t.user.email})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Estatus"}),e.jsxs("td",{className:"flex gap-2",children:[t.status.nombre,r.user.rol_id!=2&&e.jsx("span",{onClick:()=>k(!0),className:"cursor-pointer text-blue-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})})})]})]}),e.jsxs("tr",{className:"w-fit",children:[e.jsx("td",{className:"font-bold w-44 py-2",children:"Descripcion"}),e.jsx("td",{className:"flex gap-2",children:e.jsx("p",{className:"text-justify",children:t.descripcion})})]})]})]}),e.jsxs("div",{className:"flex flex-col w-full border h-92 p-4 gap-2 rounded-md",children:[e.jsx("span",{className:"font-semibold",children:"Comentarios"}),e.jsx("div",{className:"flex flex-col",children:(l==null?void 0:l.error)&&Array.isArray(l==null?void 0:l.error)&&l.error.map((s,a)=>e.jsx("h1",{className:"flex w-full text-red-400",children:s},a))}),r.user.rol_id!=2&&e.jsxs("div",{className:"flex justify-between w-full gap-5",children:[e.jsx("span",{className:"w-20",children:"Tesoria:"}),e.jsx("input",{value:E,onChange:s=>A(s.target.value),type:"text",className:"h-8 w-full rounded-md"}),e.jsx("label",{onClick:()=>y(route("comentario.create",{solicitud_id:t.id,comentario:E})),className:"bg-blue-500 px-2 py-1 rounded-lg font-semibold text-white min-w-fit cursor-pointer",children:" Agregar"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.comentarios.filter(s=>s.status==1).map(s=>e.jsxs("div",{className:"flex gap-3 w-full group ",children:[e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"w-20",children:"Tesoria:"}),e.jsxs("span",{className:"hidden text-sm group-hover:block ",children:[" ",s.created_at&&b(new Date(s.created_at),"dd/MM/yyyy")]})]}),e.jsx("span",{className:"hidden  mt-2 group-hover:block cursor-pointer self",onClick:()=>y(route("comentario.destroy",{comentario_id:s.id})),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 hover:stroke-red-600",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})})})]}),e.jsx("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap rounded-md block w-full  group-hover:overflow-visible group-hover:whitespace-normal",children:s.comentario})]},s.id))})]}),e.jsxs("div",{className:"flex flex-col w-full border h-92 p-4 gap-6 rounded-md",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{className:"font-semibold",children:"Archivos Subidos"}),t.status_id<4&&r.user.rol_id==2&&e.jsx("label",{htmlFor:"file",className:"bg-upload px-2 py-1 rounded-lg font-semibold text-white",children:" Agregar + "})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.files.filter(s=>s.user.rol_id===2).map(s=>{const a=r.user.rol_id==1||r.user.id==s.user.id;return e.jsxs("div",{onClick:()=>L(s.id),className:"text-center w-16 group relative cursor-pointer",children:[e.jsxs("div",{className:"w-16 relative",children:[e.jsx("img",{className:"w-full",src:`/assets/svg/${s.extencion}.svg`,alt:"",onError:o=>o.target.src="/assets/svg/file3.svg"}),s.confidencial?e.jsx("img",{src:"/assets/confidencial.png",className:`absolute top-0 ${a&&"w-1/2"} `,alt:""}):null,v==s.id&&(!s.confidencial||a)?e.jsx("img",{onClick:()=>z(s),src:"/assets/svg/descargar.svg",alt:"",className:"z-20 top-10 left-14 w-8 absolute transform -translate-x-1/2 hover:scale-125 "}):null]}),e.jsx("span",{className:" left-1/2 transform -translate-x-1/2  relative overflow-hidden text-ellipsis whitespace-nowrap rounded-md block w-16 group-hover:bg-gray-200 group-hover:px-1 group-hover:overflow-visible group-hover:w-fit group-hover:z-10",children:s.nombre})]},s.id)})})]}),e.jsxs("div",{className:"flex flex-col w-full border h-92 p-4 gap-6 rounded-md",children:[e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{className:"font-semibold",children:"Entregas"}),r.user.rol_id!=2&&e.jsx("label",{htmlFor:"file",className:"bg-upload px-2 py-1 rounded-lg font-semibold text-white",children:" Agregar + "})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.files.filter(s=>s.user.rol_id!=2).map(s=>e.jsxs("div",{onClick:()=>L(s.id),className:"text-center w-16 group relative cursor-pointer",children:[e.jsxs("div",{className:"w-16 relative",children:[e.jsx("img",{className:"w-full",src:`/assets/svg/${s.extencion}.svg`,alt:"",onError:a=>a.target.src="/assets/svg/file3.svg"}),v==s.id?e.jsx("img",{onClick:()=>z(s),src:"/assets/svg/descargar.svg",alt:"",className:"z-20 top-10 left-14 w-8 absolute transform -translate-x-1/2 hover:scale-125 "}):null]}),e.jsx("span",{className:" left-1/2 transform -translate-x-1/2  relative overflow-hidden text-ellipsis whitespace-nowrap rounded-md block w-16 group-hover:bg-gray-200 group-hover:px-1 group-hover:overflow-visible group-hover:w-fit group-hover:z-10",children:s.nombre})]},s.id))})]}),e.jsxs(C,{show:O,onClose:()=>{p(!1),c(!1)},children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>c(!1),className:"px-2 font-bold hover:bg-gray-300 rounded-lg",children:"x"})}),e.jsxs("form",{onSubmit:F,className:"flex flex-col w-full gap-4 text-textgray p-4",children:[e.jsxs("label",{htmlFor:"nombre",className:"text-xs flex flex-col ",children:["Numero de Solicitud",e.jsx("input",{disabled:!0,type:"text",id:"nombre",name:"nombre",value:h.numero,className:"h-9 rounded-md  outline-none px-2"})]}),e.jsxs("div",{className:"flex gap-4 justify-between ",children:[e.jsxs("label",{className:"text-xs flex flex-col  w-full",children:["Solicitud",e.jsxs("select",{required:!0,name:"solicitud_id",id:"solicitud_id",value:h.tipo_id,onChange:s=>u("tipo_id",s.target.value),className:"h-9 rounded-md  outline-none px-2",children:[e.jsx("option",{value:"",children:"Seleccione servicio"}),w.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))]})]}),e.jsxs("label",{htmlFor:"date",className:"text-xs flex flex-col max-w-[10rem]",children:["Fecha",e.jsx("input",{disabled:!0,type:"text",id:"date",name:"date",value:b(new Date(h.created_at),"dd/MM/yyyy hh:mm:ss a"),className:"h-9 rounded-md w-full outline-none px-2"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"descripcion",className:"text-xs",children:"Descripcion"}),e.jsx("textarea",{value:h.descripcion,onChange:s=>u("descripcion",s.target.value),placeholder:"Escribe tu descripcion",name:"descripcion",id:"descripcion",className:"w-full resize-none h-28 p-3 rounded-md outline-none "})]}),e.jsx("div",{className:"flex flex-col",children:(l==null?void 0:l.error)&&Array.isArray(l==null?void 0:l.error)&&l.error.map((s,a)=>e.jsx("h1",{className:"flex w-full text-red-400",children:s},a))}),e.jsx("button",{className:"border py-1 w-36 rounded-xl bg-gray-300 hover:bg-gray-200 text-textgray self-center justify-center mr-5 mt-5",children:"Guardar"})]})]})]}):null]})]})}),e.jsxs(C,{show:T,maxWidth:"sm",onClose:()=>{p(!1),c(!1)},children:[e.jsx("img",{className:"z-50 w-20 absolute left-1/2 transform -translate-x-1/2 -top-10 bg-white rounded-full p-2  ",src:"/assets/svg/check.svg",alt:""}),e.jsxs("div",{className:"text-center relative mb-2 ",children:[e.jsx("h1",{className:"mt-14 mb-8 font-semibold",children:l==null?void 0:l.success}),e.jsx("div",{className:"hover:scale-110",children:e.jsx("button",{onClick:()=>{p(!1),c(!1),k(!1)},className:"bg-green-600 rounded-lg px-3 py-1     text-lg font-bold text-white  ",children:"Cerrar"})})]})]}),e.jsx(C,{show:W,maxWidth:"sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 relative  ",children:[e.jsx("h1",{className:"font-semibold text-xl",children:"Cambiar estado de solicitud"}),e.jsx("select",{name:"statusSolicitud",id:"statusSolicitud",defaultValue:t==null?void 0:t.status.id,onChange:s=>u("status_id",s.target.value),className:"w-60 h-9 rounded-md  outline-none",children:N.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))}),e.jsxs("div",{className:"flex justify-evenly w-full",children:[e.jsx("div",{className:"hover:scale-110",children:e.jsx("button",{onClick:()=>{k(!1),c(!1)},className:"bg-green-600 rounded-lg px-3 py-1     text-lg font-bold text-white  ",children:"Cancelar"})}),e.jsx("div",{className:"hover:scale-110",children:e.jsx("button",{onClick:F,className:"bg-blue-600 rounded-lg px-3 py-1     text-lg font-bold text-white  ",children:"Guardar"})})]})]})})]})}export{P as default};
